TODO: move a copy of Casey's original pipeline here
